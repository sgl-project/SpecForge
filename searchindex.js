Search.setIndex({"alltitles": {"Advanced Features": [[9, null]], "Basic Usage": [[9, null]], "Customize Draft Model": [[1, "customize-draft-model"]], "Customize Target Model": [[1, "customize-target-model"]], "Docs Workflow": [[0, "docs-workflow"]], "Documentation Style Guidelines": [[0, "documentation-style-guidelines"]], "Eagle3 for Llama3": [[6, null]], "Examples": [[9, null]], "Get Started": [[9, null]], "Install Dependency": [[0, "install-dependency"]], "Introduction": [[6, "introduction"]], "Option 1: Conversation Format": [[4, "option-1-conversation-format"]], "Option 2: Pre-formatted Text Format": [[4, "option-2-pre-formatted-text-format"]], "SpecForge Documentation": [[0, null], [9, null]], "Step 1. Prepare environment": [[6, "step-1-prepare-environment"]], "Step 2. Prepare Model & Dataset": [[6, "step-2-prepare-model-dataset"]], "Step 3. Start Training": [[6, "step-3-start-training"]], "Step 4. benchmark": [[6, "step-4-benchmark"]], "Update Documentation": [[0, "update-documentation"]], "Workflow": [[6, "workflow"]], "\u21a9\ufe0f Regenerate Datasets": [[2, null]], "\u2601\ufe0f Prepare Online Training Dataset": [[4, "prepare-online-training-dataset"]], "\u26a1\ufe0f SGLang-ready": [[8, "sglang-ready"]], "\ud83c\udfce\ufe0f Online Training": [[5, "online-training"]], "\ud83d\udca1 Customize Your Own Training": [[1, null]], "\ud83d\udca8 Offline Training": [[5, "offline-training"]], "\ud83d\udcac Customize Chat Template": [[1, "customize-chat-template"]], "\ud83d\udcbe Prepare Offline Training Dataset": [[4, "prepare-offline-training-dataset"]], "\ud83d\udcc8 Experiment Tracking": [[5, "experiment-tracking"]], "\ud83d\udccd Overview": [[2, "overview"]], "\ud83d\udcdd Data Preparation": [[4, null]], "\ud83d\udce6 Installation": [[7, null]], "\ud83d\udd04 Regenerate Train Dataset": [[4, "regenerate-train-dataset"]], "\ud83d\udd27 Customize Training Args": [[1, "customize-training-args"]], "\ud83d\udd27 Regeneration Workflow": [[2, "regeneration-workflow"]], "\ud83d\ude80 Training": [[5, null]], "\ud83d\ude80 Which training mode should I use?": [[8, "which-training-mode-should-i-use"]], "\ud83e\udd14 Why SpecForge?": [[8, null]], "\ud83e\udd16 Benchmarking On SGLang": [[3, null]], "\ud83e\udd29 Prepare your own dataset": [[4, "prepare-your-own-dataset"]], "\ud83e\ude85 Customize Model": [[1, "customize-model"]]}, "docnames": ["README", "advanced_features/customization", "advanced_features/regenerate_dataset", "basic_usage/benchmarking", "basic_usage/data_preparation", "basic_usage/training", "examples/llama3-eagle3", "get_started/install", "get_started/overview", "index"], "envversion": {"nbsphinx": 4, "sphinx": 64, "sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1}, "filenames": ["README.md", "advanced_features/customization.md", "advanced_features/regenerate_dataset.md", "basic_usage/benchmarking.md", "basic_usage/data_preparation.md", "basic_usage/training.md", "examples/llama3-eagle3.md", "get_started/install.md", "get_started/overview.md", "index.rst"], "indexentries": {}, "objects": {}, "objnames": {}, "objtypes": {}, "terms": {"": [2, 4, 6], "0": [0, 2, 4, 6], "05": 6, "1": [0, 1, 2, 5, 8], "10": [0, 1, 6], "1000": 4, "11": 6, "12": 6, "120k": 4, "127": 6, "128": [2, 4, 6], "12tb": 8, "16": [2, 6], "1e": 1, "2": [0, 2], "200": 6, "20001": 6, "200k": 4, "2048": [1, 4], "235b": 5, "256": 6, "2a": 0, "3": [0, 1, 2, 5], "30000": [2, 4, 6], "30001": [2, 6], "30002": [2, 6], "30003": [2, 6], "30004": 6, "30b": 5, "32": [2, 6], "32b": 5, "4": [0, 1, 2, 4, 5], "5": [0, 6], "50000": 6, "512": 6, "5b": 0, "5e": 6, "5t": 4, "6": 6, "60": 6, "64": [2, 6], "7": 6, "75": 4, "8": [1, 2, 4, 6], "80": 6, "800000": 6, "8080": 0, "85": 4, "8b": [1, 2, 5, 6], "98304": 2, "As": 4, "By": 4, "For": [0, 2, 4, 6], "If": [0, 1, 4, 6], "In": [1, 2, 4, 6], "It": 9, "No": 6, "On": 9, "One": 8, "Or": 1, "TO": 6, "The": [1, 4, 6, 8], "Then": 6, "There": 8, "These": [1, 4, 6], "To": [1, 2, 4, 7], "With": [0, 6], "__init__": 1, "_config_map": 1, "_model_map": 1, "a22b": 5, "a3b": 5, "about": [4, 5], "absolut": 0, "accept": [2, 4, 6], "accommod": 8, "accord": 2, "accordingli": 0, "across": 6, "activ": [6, 8], "actual": 4, "ad": [0, 1, 5], "add": [0, 2, 4, 6], "addit": 8, "address": [2, 4, 6], "adjust": 6, "aeala": 6, "after": [0, 6], "afterward": 1, "against": 0, "ai": 0, "align": [2, 4, 6], "all": [0, 4, 6], "almost": [5, 8], "along": 6, "alreadi": 4, "also": [4, 5, 6], "altern": [0, 6], "alwai": 0, "an": [2, 5, 6, 9], "ani": 6, "anyth": 5, "appli": [0, 1], "approach": 6, "appropri": 0, "apt": 0, "ar": [0, 2, 4, 6, 8], "architectur": 1, "argument": [1, 2, 4, 5], "assist": [2, 4, 6], "assistant_head": 1, "attent": 6, "attention_mask": 1, "auto": [0, 1, 4], "autodistributedtargetmodel": 1, "autodraftmodelconfig": 1, "autoeagle3draftmodel": 1, "autoeagle3targetmodel": 1, "automat": [0, 1], "automodelforcausallmbas": 1, "aux": 4, "auxiliari": 8, "avoid": 1, "b": [2, 6], "backend": 6, "base": [1, 6], "bash": [0, 5], "batch": [1, 4, 6], "batch_siz": 6, "battl": 8, "becaus": 8, "befor": [0, 4, 6], "beforehand": 8, "begin": 6, "behavior": 4, "below": [1, 2, 4, 6, 8], "bench_model_speedup": 6, "benchmark": 9, "besid": 4, "better": [2, 4], "between": 4, "bfloat16": [2, 6], "bin": 6, "both": [4, 8], "box": 8, "branch": 0, "browser": 0, "budget": 8, "build": [0, 6], "build_eagle3_dataset_cach": 6, "byte": 8, "c": 6, "cach": [1, 2, 4, 6], "cache_dir": 6, "can": [0, 1, 2, 4, 5, 6, 7, 8, 9], "capabl": 8, "case": [0, 6], "cat": 4, "caus": 6, "causallm": 1, "cd": 6, "chang": [0, 1, 6], "chat": [4, 6], "chat_templ": 6, "chattempl": 1, "check": [0, 6], "checkpoint": 8, "chose": 6, "ci": [0, 8], "class": 1, "clean": 0, "clone": 7, "code": [0, 6, 8], "codebas": 0, "collis": 1, "columnparallellinear": 1, "com": 7, "command": [4, 5, 6, 7], "commit": [0, 6], "common": 0, "commun": 8, "compar": 4, "comparison": 8, "compat": 8, "compil": 0, "complet": 6, "complex": 0, "concurr": [2, 6], "config": [1, 6], "config_class": 1, "config_list": 6, "configur": [0, 1, 5], "consequ": 6, "consid": 0, "contain": [1, 6], "content": [4, 6], "contribut": 6, "contributor": 0, "convers": 6, "correct": [0, 1], "correctli": 6, "correspond": [4, 6], "creat": [0, 1, 6], "cuda": [2, 6], "cuda_visible_devic": 6, "current": 1, "curv": 6, "custom": [0, 9], "d": 6, "daili": 8, "data": [1, 2, 5, 6, 8, 9], "dataset": [1, 9], "dataset1": 4, "dataset2": 4, "dataset_nam": 4, "dataset_path": 6, "decid": 6, "decod": [2, 8, 9], "def": 1, "default": 4, "delet": 6, "delv": 4, "demo": 4, "depend": 6, "describ": 6, "detail": 3, "determin": 4, "dev_output": 6, "develop": 9, "dict": 1, "differ": 6, "dir": [1, 6], "directli": [0, 1, 4, 8], "directori": [1, 4], "discuss": 1, "disk": [4, 8], "displai": 0, "dist": 6, "distribut": [0, 1, 2, 4], "distributedtargetmodel": 1, "do": [0, 1, 2, 4, 6], "document": [3, 6], "doe": [1, 8], "don": 5, "done": 6, "download": 6, "draft": [2, 4, 6, 8], "dtype": [2, 6], "dure": [4, 6, 8], "e": [0, 2, 6, 8], "each": [0, 1, 6, 8], "eagl": [2, 6], "eagle1": 2, "eagle3": [1, 5, 8, 9], "eagle3draftmodel": 1, "easili": 4, "ecosystem": 9, "effici": 4, "effort": 8, "enabl": [4, 5], "encod": 6, "end_of_turn_token": 1, "enjoi": 8, "ensur": 0, "entir": 6, "entri": [1, 6], "environ": 2, "epoch": [1, 6], "epoch_0": 6, "error": [0, 6], "eval": 6, "even": 2, "everi": 0, "everyon": 8, "everyth": 5, "exampl": [0, 2, 4, 5, 6], "except": 5, "exec": 0, "execut": 0, "exist": 0, "experi": 6, "explain": 6, "export": 6, "extract": 4, "face": 6, "fail": 0, "fast": 8, "faster": 1, "featur": 0, "fed": 8, "feel": 6, "file": [0, 1, 2, 4, 5, 6], "fill": 8, "find": 0, "first": [0, 6, 8], "fix": 0, "flag": 4, "flex_attent": 6, "fly": 8, "folder": 0, "follow": [0, 2, 4, 5, 6, 7], "footprint": 8, "format": 8, "found": 6, "four": 6, "frac": [2, 4, 6], "fraction": [4, 6], "framework": [8, 9], "free": 6, "from": [0, 1, 4, 6, 7], "frozen": 8, "fsdp": 8, "full": [1, 6], "fulli": 0, "function": 0, "g": [0, 2, 6, 8], "gener": [1, 4, 6, 8], "generate_data_by_target": 6, "generationmixin": 1, "get": 0, "get_start": 0, "git": 7, "github": 7, "given": 8, "go": 4, "goal": 6, "good": 2, "gpu": [2, 8], "graph": [2, 6], "greater": 1, "green": 6, "gsm8k": 6, "guarante": 8, "guid": 6, "ha": 1, "happi": 8, "hardcod": 1, "hardwar": 8, "hash": 1, "have": [4, 5, 6, 8], "help": [0, 1, 4, 6], "hf": 6, "hidden": [4, 5, 8], "hour": 4, "how": [0, 4], "howev": [1, 2], "html": 0, "http": [0, 7], "hug": 6, "huge": 8, "huggingfac": [1, 4], "huggingfaceh4": 6, "humanev": 6, "i": [0, 1, 2, 4, 5, 6, 9], "id": [4, 6], "identifi": 4, "ignor": 6, "im_end": 4, "im_start": 4, "implement": 1, "import": [0, 1, 6], "improv": [2, 4], "includ": [1, 4, 6], "increas": 6, "index": [0, 6], "indic": 6, "infer": [4, 9], "inherit": 1, "input": [2, 4, 6], "input_id": 1, "inspect": 6, "instal": [6, 9], "instead": [2, 5], "instruct": [0, 1, 2, 5, 6], "interact": 0, "introduc": 4, "ipynb": 0, "its": [1, 6], "json": [1, 6], "jsonl": [1, 2, 4, 6], "jupyt": 0, "just": 4, "k": 6, "keep": [0, 8], "kei": 6, "kwarg": 1, "larg": [1, 8], "launch": [0, 4, 6], "launch_serv": [2, 6], "layer": 1, "lazi": 1, "lead": 4, "learn": [0, 1, 6], "length": [1, 4, 6], "like": [4, 6], "line": [5, 6], "linear": 1, "liner": 8, "link": 0, "lint": 0, "list": [1, 6], "llama": [1, 2, 5, 6], "llama3": [1, 4, 5, 9], "llama4": 5, "llama4forcausallm": 1, "llama4textconfig": 1, "llamaconfig": 1, "llamaforcausallmeagle3": 1, "load": 1, "load_dataset": 6, "load_weight": 1, "local": [0, 6, 8], "localhost": 2, "locat": 0, "log": 5, "long": [0, 1], "look": [2, 4], "loss": [4, 6], "loss_mask": [1, 6], "low": 8, "m": [2, 6], "mai": 4, "maintain": 8, "make": [0, 1, 4, 5, 6], "mani": [4, 8], "manipul": 8, "manner": 5, "manual": 0, "map": 1, "markdown": 0, "mask": [4, 6], "match": [1, 4], "math500": 6, "matter": 8, "max": [1, 2, 4, 6], "max_length": 6, "maximum": 2, "md": 0, "mean": 2, "mem": [2, 4, 6], "memori": 8, "mention": 4, "merg": [4, 6], "merged_dataset": 4, "messag": [4, 6], "meta": [1, 2, 6], "method": [2, 8], "might": 6, "min": 0, "mind": 0, "minut": 8, "misalign": 4, "mode": 2, "model": [0, 2, 4, 5, 8, 9], "model_path": 6, "model_typ": 1, "modifi": 1, "more": [2, 3, 4, 8], "most": [0, 6, 8], "mtbench": 6, "much": [0, 1], "multipl": 4, "must": [1, 6], "my": 6, "mymodel": 1, "mymodelconfig": 1, "mymodeleagle3": 1, "mymodelforcausallm": 1, "mymodelpretrainedmodel": 1, "n": 4, "name": [0, 1, 4, 6], "nbstripout": 0, "need": [1, 4, 5, 6, 8], "new": [0, 1], "next": 6, "nhello": 4, "nhi": 4, "none": 1, "note": 4, "notebook": 0, "nproc_per_nod": [1, 4, 6], "num": [1, 4, 6], "num_gpu": 6, "num_step": 6, "num_verify_token": 6, "number": [2, 6], "nyou": 4, "obtain": [1, 4, 6], "occur": 6, "offici": 6, "offlin": 8, "onc": [1, 4, 8], "one": 4, "onli": [4, 6, 8], "onlin": [6, 8], "open": [0, 8], "optim": 2, "option": 6, "orient": 6, "origin": 2, "orthogon": 8, "other": [0, 1, 4, 6], "our": [0, 8], "out": [6, 8], "output": [0, 1, 2, 4, 6], "output_dir": 6, "output_path": 6, "over": [0, 9], "overal": [2, 4], "overview": 4, "own": [2, 6, 9], "pandoc": 0, "paper": [2, 6], "parallel": [0, 1, 2, 8], "paramet": 4, "particularli": 1, "pass": [0, 1, 5], "path": [1, 2, 4, 5, 6, 8], "per": 6, "perfectblend_train": 2, "perfectblend_train_regen": 2, "perform": [2, 4, 6, 8], "pick": 8, "pip": [0, 6, 7], "pipelin": 0, "place": 4, "pleas": [1, 3, 6], "port": [0, 2, 4, 6, 8, 9], "possibl": 0, "post": 8, "pr": 0, "pre": [0, 6], "prefer": 0, "preformat": 4, "prepar": [5, 8, 9], "prepare_data": [4, 6], "prepare_hidden_st": 4, "pretrainedconfig": 1, "preview": 0, "previou": 4, "process": [4, 6, 8], "product": 2, "progress": 5, "project": [4, 5, 6, 7, 8, 9], "prompt": [4, 6], "provid": [1, 4, 5, 6, 8], "public": 4, "pull": 0, "purpos": 4, "push": 0, "py": [1, 2, 4, 6], "pypi": 7, "python": [1, 2, 4, 6], "python3": [2, 4, 6], "qualiti": 2, "quant_config": 1, "queri": 0, "quickli": 0, "qwen": [0, 4], "qwen2": 0, "qwen3": 5, "qwq": 5, "r": [0, 6], "ram": 8, "rate": [1, 2, 4, 6], "ratio": 6, "rational": 8, "raw": [4, 6], "re": 0, "readi": 4, "rebuild": 0, "recommend": [0, 2, 4, 7], "record": 6, "red": 6, "reduc": [0, 4], "refer": 3, "regardless": 8, "regener": [6, 9], "regenerate_data": 4, "regenerate_train_data": 2, "regist": 1, "registri": 1, "regularli": 8, "rel": 0, "relev": 0, "rememb": 0, "remot": 6, "remov": 0, "replac": 2, "repo": [4, 6], "report": [5, 6], "repositori": 6, "repres": 6, "reproduc": 6, "request": [0, 6], "requir": [0, 1, 4, 6, 8], "resid": 8, "resolv": 0, "respons": [2, 6], "result": 6, "retri": 0, "reus": 0, "review": 6, "role": [4, 6], "row": 6, "rowparallellinear": 1, "rst": 0, "run": [0, 1, 4, 5, 6, 7], "run_llama3_eagle3_offlin": 5, "run_llama3_eagle3_onlin": 5, "run_llama3_eagle3_sgl_onlin": 6, "run_llama4_eagle3_onlin": 5, "run_qwen3_dense_eagle3_onlin": 5, "run_qwen3_moe_eagle3_onlin": 5, "run_qwq_eagle3_onlin": 5, "runnabl": [0, 8], "safe": 6, "same": 5, "sampl": [4, 6, 8], "save": 6, "scale": 2, "schema": 4, "scout": 5, "script": [1, 2, 4, 5, 6], "second": 6, "section": 4, "see": [1, 6], "seen": 8, "select": 6, "self": 1, "send": 0, "sensit": 2, "serv": [0, 1, 9], "server": [0, 2, 4, 6], "set": [1, 6], "setuptools_use_distutil": 6, "sgl": [6, 7], "sglang": [0, 1, 2, 6, 9], "sh": [0, 5, 6], "shard": 6, "sharegpt": [1, 4, 5, 6, 8], "sharegpt_ultrachat_test": 6, "sharegpt_ultrachat_train": 6, "sharegpt_vicuna_unfilt": 6, "shell": 5, "should": [1, 4, 6], "simpl": 5, "simpli": [2, 6, 7], "sinc": 6, "size": [1, 4, 6], "skip": 0, "small": [0, 8], "smoothli": 9, "so": [0, 1, 6, 8, 9], "some": [0, 1, 4], "someth": 4, "sourc": [6, 7, 8], "space": 8, "span": [4, 6], "specforg": [1, 6, 7], "specif": [2, 4], "specifi": [1, 4], "specul": [2, 6, 8, 9], "speed": 9, "split": 6, "stai": 0, "standalon": [1, 4, 6], "start": [0, 2, 4, 5, 8], "startup": 5, "state": [4, 5, 8], "state_dict": 1, "static": [4, 6], "step": [0, 2, 4, 5], "still": [2, 4], "storag": 8, "store": 8, "str": 1, "straight": 4, "structur": 6, "subdirectori": 0, "submodul": 1, "success": 6, "suggest": 6, "suit": [6, 8], "support": [1, 4, 5], "sure": [0, 1, 4, 5, 6], "swanlab": 5, "system": [4, 6], "system_prompt": [1, 6], "t": 5, "take": [0, 4], "target": [2, 4, 5, 6, 8], "team": [8, 9], "temperatur": [2, 4], "templat": [4, 6], "template_registri": 1, "tensor": [1, 8], "tensorboard": 5, "test": [6, 8], "test_d": 6, "test_siz": 6, "text": 6, "than": 1, "thei": 0, "them": [4, 6, 8, 9], "thi": [0, 1, 2, 4, 5, 6, 7, 8], "those": 6, "through": 6, "thu": 4, "time": 0, "timeout": 6, "tip": 0, "to_json": 6, "token": [2, 4, 6, 8], "too": 1, "top": 6, "topk": 6, "torch": 1, "torchrun": [1, 4, 6], "total": 6, "tp": [4, 6], "tp_size": 1, "trade": 8, "train": [2, 9], "train_d": 6, "train_eagle3": [1, 4], "train_eagle3_sgl_onlin": 6, "train_test_split": 6, "transform": 1, "true": 6, "trust": 6, "two": [4, 8], "txt": [0, 6], "type": 6, "typic": 6, "ultrachat": [4, 6, 8], "ultrachat_200k": 6, "uncom": 6, "under": [0, 6], "understand": [0, 1], "up": [8, 9], "updat": 6, "upload": 6, "us": [0, 1, 2, 4, 6], "user": [4, 6], "user_head": 1, "uv": 6, "v": [6, 7], "valid": 0, "valu": [1, 6], "venv": 6, "veri": 2, "verifi": 6, "version": 1, "via": 1, "view": [0, 6], "virtual": 6, "vocab_map": 1, "vocabulari": 6, "wai": [0, 1, 6], "walk": 6, "wandb": [5, 6], "want": [1, 6], "warmup": 6, "warn": 6, "we": [0, 1, 2, 4, 5, 6, 8], "weight": 8, "welcom": 6, "well": [1, 8], "were": 4, "what": 1, "when": [0, 1, 2, 4, 6], "where": 6, "whether": 6, "which": [0, 1, 2, 4], "whichev": 8, "while": 4, "wish": [1, 8], "without": [6, 8], "word": 6, "write": [0, 1], "xxx": [1, 6], "xxxx": 4, "y": 0, "you": [0, 1, 2, 4, 5, 6, 7, 8, 9], "your": [0, 2, 5, 6, 8, 9], "your_preformatted_dataset": 4, "zero": [6, 8], "zhuyksir": 6}, "titles": ["SpecForge Documentation", "\ud83d\udca1 Customize Your Own Training", "\u21a9\ufe0f Regenerate Datasets", "\ud83e\udd16 Benchmarking On SGLang", "\ud83d\udcdd Data Preparation", "\ud83d\ude80 Training", "Eagle3 for Llama3", "\ud83d\udce6 Installation", "\ud83e\udd14 Why SpecForge?", "SpecForge Documentation"], "titleterms": {"1": [4, 6], "2": [4, 6], "3": 6, "4": 6, "On": 3, "advanc": 9, "arg": 1, "basic": 9, "benchmark": [3, 6], "chat": 1, "convers": 4, "custom": 1, "data": 4, "dataset": [2, 4, 6], "depend": 0, "doc": 0, "document": [0, 9], "draft": 1, "eagle3": 6, "environ": 6, "exampl": 9, "experi": 5, "featur": 9, "format": 4, "get": 9, "guidelin": 0, "i": 8, "instal": [0, 7], "introduct": 6, "llama3": 6, "mode": 8, "model": [1, 6], "offlin": [4, 5], "onlin": [4, 5], "option": 4, "overview": 2, "own": [1, 4], "pre": 4, "prepar": [4, 6], "readi": 8, "regener": [2, 4], "sglang": [3, 8], "should": 8, "specforg": [0, 8, 9], "start": [6, 9], "step": 6, "style": 0, "target": 1, "templat": 1, "text": 4, "track": 5, "train": [1, 4, 5, 6, 8], "updat": 0, "us": 8, "usag": 9, "which": 8, "why": 8, "workflow": [0, 2, 6], "your": [1, 4]}})